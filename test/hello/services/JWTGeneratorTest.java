package hello.services;
import static org.junit.Assert.*;

import org.junit.Test;

import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;

public class JWTGeneratorTest {

    private JWTGenerator tokenGenerator = new JWTGenerator("MIIEwAIBADANBgkqhkiG9w0BAQEFAASCBKowggSmAgEAAoIBAQCtH0Tw2BcvrgjIMMYnfvrVVysmgDtyxkknojxcaH4dy+fCKGxsJuADn5DxCclY0q7xRZ8CSOasp71LbS78j99HHtmGGIl7Gs2J/bKrce1aJd2I7DRaoVRumEkmKk9Rgzur0phTflhf3CBStKedU758yMGVtEgmlDph3gue/VRKVs3wMXOI2FnGqhwSO4tZjpCjEnbVkYruZ/U93YUa6SdiOlLDgA3IUUqIaPmB0r9lzZU8t9qmSzdcCBdZQd48RgyhkIp618p/EV0YWQQm/GSBxdyEaVZOYLqK9bhnp1jSybJJvmeyj07haHMuCB5UdtzX7uBER6qH7U0b0nnUH1P7AgMBAAECggEBAKtgRPLWNz2v3mmuPrpibRQ8Ei8uyaq4tzpQ08f2eMIuU+JT+eCmKyPrFaRGt9cB2MRm0x2D5TYNZsn/7399PN4+n76rE42V3to3FmO5h+ixizg7+yeshNRmVCM/xv0+GBfjhX9Bl2JtmmHFDBgmCm+knF4B9VqbaZ/wGzjsNkDPQ6t69nZRHxBNeAjd3F7mJ2K9MijKkv3aVWuX13V38nQ8gIBn1iOcnIDSPXYgB627OROr9Z23eHszE5/zcZ4l7xrzjuDgT2gADxg5EF4ymjHve8St9lvjuPT8jWtTczCKG8S/lBKnRrAjI5TjGwLm4abOa+H/H++VEBfIuQXZ1mECgYEA4IP1a/HufkYdLtHRPcY3G3pTeCRjkcbmnvCcZiomhb9KeCe1oNM0fJwjWjbNShKvyVB/k5MMtORB0qnWuJ+zKvbcB2QvFNvq2ABLrTMo7r3e1XSqC9y5xBoMTWOrBiz6JiSRylWSYJJFjtnbCU2zmAQ3QPEm2i734mDXHoD90U0CgYEAxWZOHELtwCihuotZmUW83E3F34bYF/aBr+5nUmAOKG5FHa/RuTpMbJPe+FxIeEj8x/80LzwaxB5cMGAHZuNFmSroXvUS7zdI9szrexGtc2E261QVvkp33ChxEld+wGTCik2RaGY1Wm553NTSDnPOgT3JAXOxxB66Sp9bUexRlmcCgYEAuj4c72+g9JT7DmS1G3Z7LksaRLaC9mG127EjPEjI7fgSMXxXWdL6Xkgzt1lwkHrR4cDqI6Q/TStwQu3qlfq8aO6g9Wyw9a+8r3QHUuT2lp1g5VdC3FY8r6UgAW6lZ5kV5WA+pEa6B2wvUWH9JkmTqo4Mu82P+jwuG1dT/BTq+J0CgYEAlO7ZJA2DH6YIT5xvn2q0UWsETd+JDptXwYsXvVjnla2MzBcpHp1Tp9/xLGVD8CzxO1va3YB1mV5mo8DwFLqIekWbSHmTLZUCoeJ+ED6IJTNFokuwk//PavXASdxlr3bWKE7Z1HC49F/B5dFUIr9RIMWi8Et/5b5hQ4fz+F1aOSUCgYEAkQz7Ir7mY2yrSDZ7o6usYIaws+b2VP58YlBKFw9cf6cFT4/2RFlnAGDQtPWiSsyCQS26uI14/n5iCcTBq18nbeFm89jLNNBvWC72UHHOW1qMlm4Xi8YPGQWhxAAQ522xvE6JT/AKDV/jCMmc3SL/MaVjgavBZGdC1IeGQijycb4=");


    @Test
    public void generatesAJWT() throws InvalidKeySpecException, NoSuchAlgorithmException {
        assertEquals("eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJzdWIiOiJzb21lLXVzZXJuYW1lIiwiaXNzIjoiZXhhbXBsZS1hdXRoLXNlcnZpY2UifQ.KxoAfkNuEuSGxnZt4QZ7HrhibSU4nUUhT76j3bUNGMv8mVewUb3oOh8sn4zjSYvwW2LSWFeonNuodeU3bgZ_bNpc04bHhgdmNp9LMirTmPnHz9EzP_z8xZ94qfyXanSyIiVl-22VGvbJ_k-vnrvj2Q2O_3BdiDNzkhBTsYlcbuZrrDDR9zq9hb1x0OhlAZH0fbLo_4CnHgc7wPasfaVQsJo0xd2m0D94qv1RSIcQ0LRPS2hlv7YUUB2ObQiJKQFOYYm8nWxZuh7F1u9i2zBJkv0rVAcDCT6tJ5aWl2f9sccjLVVqpudMT6Hu8AGx11o3Qi0iWv-oiaBtKUcqH7BWqw", tokenGenerator.generate("some-username"));
    }

}
